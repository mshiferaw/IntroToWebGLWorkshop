<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
    </head>
    <body style="margin: 0;">
        
        <!-- Include JavaScript libraries here -->
        <script src="three/three.js"></script>
        <script src="three/OrbitControls.js"></script>
        <script src="three/ColladaLoader.js"></script>
        
        <script>
                        
            // Declare global variables
            var scene, 
                cam, 
                renderer, 
                controls;
            
            // Call main
            main();
            
            // Define main: initializes required objects and updates scene
            function main(){
                initializeScene();
                updateLoop();
            }
            
            function initializeScene(){                
                // 1) Initialize the scene variable with a three.js scene object.
                scene = new THREE.Scene();
                
                // 2) Initialize the camera variable and set its position.
                cam = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
                cam.position.set(3, 2, 3);
                
                // 3) Initialize the renderer with a three.js WebGLRenderer object, and enable antialiasing.
                renderer = new THREE.WebGLRenderer({antialias: true});
                renderer.setSize(window.innerWidth, window.innerHeight);
                renderer.setPixelRatio(window.devicePixelRatio);
                renderer.setClearColor(0x525252, 1);
                
                // 4) Initialize the controls with a three.js OrbitCOntrols object, attach the controls to
                // camera and add controls to the renderer DOM element.
                controls = new THREE.OrbitControls(cam, renderer.domElement);
                controls.enableDamping = true;
                controls.target.set(0.0, 1.16, 0.0);
                controls.addEventListener('change', renderScene);
                
                // 5) Create two three.js lights and add them to the scene.
                var ambLight = new THREE.AmbientLight(0xCFCFCF);
                scene.add(ambLight);
                var keyLight = new THREE.PointLight(0xFFFFFF, 1, 50, 1);
                keyLight.position.set(0,5,3);
                scene.add(keyLight);
                
                // 6) Create a three.js AxesHelper at the center of the world.
                var jack = new THREE.AxesHelper(3);
                scene.add(jack);
                
                // Call loadMesh function before appending the renderer to the document body
                loadMesh();

                // 7) Lastly for the initializeScene() function, the renderer is added to the page
                document.body.appendChild(renderer.domElement);
            }
            
            // Define updateLoop
            function updateLoop(){
                requestAnimationFrame(updateLoop);
                controls.update();
            }
            
            // Define renderScene
            function renderScene(){
                renderer.render(scene, cam);
            }
            
            // Define a function to load the data
            function loadMesh(){
                // 1) Declare a loader object to load the data.
                var loader = new THREE.ColladaLoader();
                
                // 2) Create a material for the object.
                var hurricaneMaterial = new THREE.MeshLambertMaterial();
                hurricaneMaterial.vertexColors = 1;
                
                // 3) Load the Katrina.dae file.
                loader.load('OneDrive/CIERA_REU/IntroToWebGLWorkshop-mshiferaw-patch-1-v4/IntroToWebGLWorkshop-mshiferaw-patch-1/WebGLProject/Data/Katrina.dae', function(hurricaneModel) {
                                                hurricaneModel.scene.children[0].material = hurricaneMaterial;
                                                scene.add(hurricaneModel.scene.children[0]);
                                                renderScene();
                                            }
                                        );
            }
                
            
    }
        </script>
    </body>
</html>
